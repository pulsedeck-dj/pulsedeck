<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PulseDeck DJ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Grotesk:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="bg-orb bg-orb-a"></div>
    <div class="bg-orb bg-orb-b"></div>

    <main class="layout">
      <header class="hero">
        <p class="eyebrow">PulseDeck DJ Desktop</p>
        <h1>Official DJ Control</h1>
        <p class="subtitle">Connect your booth, watch the queue in realtime, and share your party with one QR.</p>
        <p id="statusText" class="status-text">Not connected.</p>
      </header>

      <nav class="window-tabs" aria-label="DJ windows">
        <button id="tabBoothBtn" class="window-tab is-active" type="button">DJ Booth</button>
        <button id="tabStageBtn" class="window-tab" type="button">Stage</button>
        <button id="tabRequestsBtn" class="window-tab" type="button">
          Requests
          <span id="requestCountTab" class="tab-count">0</span>
        </button>
        <button id="tabPlayedBtn" class="window-tab" type="button">
          Played
          <span id="playedCountTab" class="tab-count">0</span>
        </button>
        <button id="tabShareBtn" class="window-tab" type="button">Share</button>
      </nav>

      <section id="boothWindow" class="window-panel">
        <article class="panel panel-form">
          <div class="panel-head">
            <h2>Connection</h2>
            <span id="statusPill" class="status-pill status-idle">Idle</span>
          </div>

          <div class="form-grid">
            <label for="partyCode">Party Code</label>
            <input id="partyCode" maxlength="6" />

            <label for="djKey">DJ Key</label>
            <input id="djKey" type="password" />
          </div>

          <div class="button-row">
            <button id="saveBtn" class="btn btn-ghost">Save Settings</button>
            <button id="connectBtn" class="btn btn-primary">Connect</button>
            <button id="disconnectBtn" class="btn btn-secondary">Disconnect</button>
            <button id="showQrBtn" class="btn btn-accent">Show Guest QR</button>
          </div>
        </article>

        <article class="panel">
          <div class="panel-head">
            <h2>Quick Tools</h2>
          </div>
          <div class="button-row button-row-tools">
            <button id="copyPartyCodeBtn" class="btn btn-ghost">Copy Party Code</button>
            <button id="copyGuestUrlBtn" class="btn btn-ghost">Copy Guest URL</button>
            <button id="jumpRequestsBtn" class="btn btn-primary">Open Requests</button>
          </div>
          <p class="hint">Use these during the party to share code quickly and jump to the live queue.</p>
        </article>
      </section>

      <section id="requestsWindow" class="window-panel hidden">
        <section class="grid-two">
          <article class="panel">
            <div class="panel-head">
              <h2>Song Queue</h2>
              <div class="panel-head-actions">
                <button id="queueOrderBtn" class="btn btn-ghost btn-mini" type="button">Oldest first</button>
                <span id="requestCount" class="count-pill">0</span>
              </div>
            </div>
            <div class="queue-toolbar">
              <input
                id="queueFilter"
                type="text"
                autocomplete="off"
                placeholder="Filter by title, artist, or service..."
                aria-label="Filter queue"
              />
            </div>
            <div id="requestsList" class="requests-list"></div>
          </article>

          <article class="panel">
            <div class="panel-head">
              <h2>Activity Log</h2>
              <button id="clearLogBtn" class="btn btn-ghost btn-mini" type="button">Clear Log</button>
            </div>
            <div id="logList" class="log-list"></div>
          </article>
        </section>
      </section>

      <section id="stageWindow" class="window-panel hidden">
        <section class="grid-two">
          <article class="panel stage-panel">
            <div class="panel-head">
              <h2>Next Up</h2>
              <div class="panel-head-actions">
                <button id="stageSetupBtn" class="btn btn-ghost btn-mini" type="button">Setup</button>
                <button id="stageOverlayBtn" class="btn btn-ghost btn-mini" type="button">Overlay</button>
                <span id="stageSeq" class="count-pill">--</span>
              </div>
            </div>

            <div id="stageCard" class="stage-card">
              <p id="stageService" class="stage-service">No queued songs yet.</p>
              <p id="stageTitle" class="stage-title">Waiting for guests...</p>
              <p id="stageArtist" class="stage-artist">Share your QR and let the requests roll in.</p>
              <p id="stageMeta" class="stage-meta"></p>
            </div>

            <div class="stage-actions">
              <button id="stageMarkPlayedBtn" class="btn btn-success" type="button">Mark Played</button>
              <button id="stageSkipBtn" class="btn btn-danger" type="button">Skip</button>
              <a id="stageOpenLinkBtn" class="btn btn-ghost" href="#" target="_blank" rel="noreferrer noopener"
                >Open Link</a
              >
              <button id="stageCopyBtn" class="btn btn-ghost" type="button">Copy</button>
            </div>

            <p class="hint">Stage view always shows the top of your current queue.</p>
          </article>

          <article class="panel">
            <div class="panel-head">
              <h2>Up Next</h2>
              <span id="stagePreviewCount" class="count-pill">0</span>
            </div>
            <div id="stagePreviewList" class="requests-list"></div>
            <p class="hint">Tip: Use Requests for full queue management and Played for history.</p>
          </article>
        </section>
      </section>

      <section id="playedWindow" class="window-panel hidden">
        <article class="panel">
          <div class="panel-head">
            <h2>Played Requests</h2>
            <span id="playedCount" class="count-pill">0</span>
          </div>
          <div class="queue-toolbar">
            <input
              id="playedFilter"
              type="text"
              autocomplete="off"
              placeholder="Filter played songs..."
              aria-label="Filter played songs"
            />
          </div>
          <div id="playedList" class="requests-list"></div>
          <p class="hint">Mark a request as played in Requests to move it here.</p>
        </article>
      </section>

      <section id="shareWindow" class="window-panel hidden">
        <section class="grid-two">
          <article class="panel">
            <div class="panel-head">
              <h2>Share To Guests</h2>
              <span class="count-pill">Live</span>
            </div>

            <div class="share-grid">
              <div class="share-block">
                <p class="share-label">Party Code</p>
                <p id="sharePartyCode" class="share-code">------</p>
              </div>

              <div class="share-block">
                <p class="share-label">Guest URL</p>
                <p id="shareGuestUrl" class="share-url">Set party code to generate link.</p>
              </div>
            </div>

            <div class="share-actions">
              <button id="shareRefreshBtn" class="btn btn-primary" type="button">Generate / Refresh</button>
              <button id="shareCopyCodeBtn" class="btn btn-ghost" type="button">Copy Code</button>
              <button id="shareCopyUrlBtn" class="btn btn-ghost" type="button">Copy Guest URL</button>
              <button id="shareFullscreenBtn" class="btn btn-accent" type="button">Fullscreen QR</button>
            </div>

            <p class="hint">
              Guests should open the request website, enter the party code, and pick a song. Keep DJ key private.
            </p>
          </article>

          <article class="panel">
            <div class="panel-head">
              <h2>Guest QR</h2>
              <button id="shareCopyQrUrlBtn" class="btn btn-ghost btn-mini" type="button">Copy QR URL</button>
            </div>
            <div class="share-qr-wrap">
              <img id="shareQrImage" class="share-qr" alt="Guest QR code" />
              <p class="micro-note">Tip: Tap Fullscreen QR before the crowd arrives.</p>
            </div>
          </article>
        </section>
      </section>
    </main>

    <div id="qrModal" class="qr-modal hidden" aria-hidden="true">
      <div class="qr-stage">
        <div class="qr-light qr-light-a"></div>
        <div class="qr-light qr-light-b"></div>
        <section class="qr-card" role="dialog" aria-modal="true" aria-label="Guest QR code">
          <button id="qrCloseBtn" class="btn btn-ghost qr-close">Close</button>
          <p class="eyebrow">Guest Join Portal</p>
          <h2 id="qrPartyCode" class="qr-party-code">------</h2>
          <p class="qr-subtitle">Scan this QR to open the request page with the party code already filled in.</p>
          <img id="qrImage" class="qr-image" alt="Guest QR code" />
          <p id="qrUrl" class="qr-url"></p>
          <div class="qr-export">
            <div class="qr-presets" role="group" aria-label="Export size">
              <button id="qrPresetIphoneBtn" class="seg-btn is-active" type="button">iPhone</button>
              <button id="qrPresetIpadBtn" class="seg-btn" type="button">iPad</button>
            </div>
            <button id="qrDownloadBtn" class="btn btn-primary" type="button">Download PNG</button>
          </div>
        </section>
      </div>
    </div>

    <div id="setupModal" class="qr-modal hidden" aria-hidden="true">
      <div class="qr-stage">
        <div class="qr-light qr-light-a"></div>
        <div class="qr-light qr-light-b"></div>
        <section class="qr-card" role="dialog" aria-modal="true" aria-label="Playback setup">
          <button id="setupCloseBtn" class="btn btn-ghost qr-close">Close</button>
          <p class="eyebrow">Playback Setup</p>
          <h2 class="qr-party-code" style="font-size: 44px; letter-spacing: 0.04em">Play Requests</h2>
          <p class="qr-subtitle">
            PulseDeck manages the queue and links. It does not download Apple Music tracks or use Apple Music account cookies.
          </p>

          <div style="text-align: left; margin-top: 12px">
            <ol class="hint" style="margin: 0; padding-left: 18px">
              <li>Connect PulseDeck DJ to your party.</li>
              <li>In Stage or Overlay, click <strong>Open Link</strong> for the next request.</li>
              <li>Play it in Apple Music or your DJ software (if supported).</li>
              <li>Tap <strong>Played</strong> or <strong>Skip</strong> to keep the list clean.</li>
            </ol>
          </div>

          <div class="qr-export" style="margin-top: 16px">
            <button id="setupOpenAppleMusicWebBtn" class="btn btn-primary" type="button">Open Apple Music</button>
            <button id="setupOpenGuestSiteBtn" class="btn btn-ghost" type="button">Open Guest Site</button>
          </div>
        </section>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
