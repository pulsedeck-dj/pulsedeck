<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PulseDeck Guest Requests</title>
    <meta name="theme-color" content="#00b9ff" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Grotesk:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="page-guest">
    <div class="shape shape-a" aria-hidden="true"></div>
    <div class="shape shape-b" aria-hidden="true"></div>
    <div class="shape shape-c" aria-hidden="true"></div>

    <main class="shell">
      <header class="hero reveal">
        <p class="eyebrow">PulseDeck Guest Portal</p>
        <h1>Request A Song</h1>
        <p class="subtitle">Enter the party code shown on the DJ screen.</p>
      </header>

      <section class="window-panel reveal delay-1">
        <article class="panel" id="joinPanel">
          <div class="panel-head">
            <h2>Party Code</h2>
            <span class="chip">Guest</span>
          </div>

          <form id="joinForm" class="form-grid">
            <label for="partyCode">Code</label>
            <input id="partyCode" maxlength="6" autocomplete="off" placeholder="ABC123" required />
            <button type="submit" class="btn btn-secondary">Join</button>
          </form>

          <p id="joinResult" class="status status-neutral" aria-live="polite">Waiting for code.</p>
          <button id="stopCheckingBtn" class="btn btn-ghost btn-mini hidden" type="button">Stop Checking</button>
        </article>

        <article class="panel hidden" id="requestPanel">
          <div class="panel-head">
            <h2>Song Request</h2>
            <span class="chip">Live</span>
          </div>
          <p id="guestPartyName" class="micro-note" style="margin-top: -6px; margin-bottom: 10px"></p>

          <form id="requestForm" class="form-grid">
            <div id="appleSearchSection" class="apple-search">
              <label for="appleSearchTerm">Search Music</label>
              <div class="search-row">
                <input id="appleSearchTerm" maxlength="120" placeholder="Type a song or artist" />
              </div>
              <p id="appleSearchStatus" class="status status-neutral">Search to autofill song info.</p>
              <div id="appleSearchResults" class="search-results"></div>
            </div>

            <div id="pickedSongPanel" class="picked-song hidden" aria-live="polite">
              <p class="mini-label">Selected song</p>
              <p id="pickedSongTitle" class="picked-title">None</p>
              <p id="pickedSongArtist" class="picked-artist"></p>
              <div class="picked-actions">
                <button id="pickedChangeBtn" class="btn btn-ghost" type="button">Change</button>
                <button id="pickedSubmitBtn" class="btn btn-primary" type="button">Submit Request</button>
              </div>
            </div>

            <input id="title" type="hidden" maxlength="120" required />
            <input id="artist" type="hidden" maxlength="120" required />

            <!-- Submit lives in the Selected Song card to avoid duplicate buttons. -->
          </form>

          <p id="requestResult" class="status status-neutral" aria-live="polite">No request submitted yet.</p>
        </article>
      </section>

      <p class="micro-note reveal delay-2">PulseDeck requests are delivered securely to the DJ queue in realtime.</p>
    </main>

    <script src="vendor/supabase.js"></script>
    <script src="config.js"></script>
    <script src="guest.js"></script>
  </body>
</html>
